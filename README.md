# Прогноз урожайности зерновых по спутниковым данным и метеоинформации

## Описание задачи

- **Задача**: Регрессия — предсказание урожайности зерновых (ц/га) по временным рядам
- **Модели**: LSTM, Transformer, гибрид CNN-LSTM
- **Данные**: Спутниковые индексы (NDVI, EVI) + метеорологические данные
- **Регионы**: Краснодарский край, Ростовская область, Ставропольский край, Саратовская область, Алтайский край
- **Период**: 2010-2023 гг.

## Требования

- Интеграция спутниковых индексов (NDVI, EVI) и метеоданных
- Оценка качества моделей с помощью метрик MAE, RMSE
- Визуализация прогнозов по регионам

## Цель и обоснование

Точный прогноз урожайности необходим для:
- Планирования продовольственной безопасности
- Оптимизации сельскохозяйственных ресурсов
- Прогнозирования рыночных цен
- Страхования и оценки рисков

Проект демонстрирует применение методов глубокого обучения (LSTM, CNN-LSTM, Transformer) к временным рядам агроклиматических данных.

## Источники данных

### Метеорологические данные
- **Источник**: NASA POWER API
- **Переменные**: 
  - T2M_mean — средняя температура (°C)
  - PRECTOT_mm — сумма осадков (мм)
  - SOLAR_RAD_MJ — солнечная радиация (МДж/м²)

### Спутниковые индексы
- **NDVI** (Normalized Difference Vegetation Index) — индекс вегетации
- **EVI** (Enhanced Vegetation Index) — улучшенный индекс вегетации
- **Источник**: MODIS/VIIRS спутниковые продукты

### Данные об урожайности
- **Регионы**: 5 регионов России
- **Период**: 2010-2023 гг.
- **Целевая переменная**: Урожайность зерновых (ц/га)

## Структура проекта

```
crop_yield_prediction/
├── data/                          # Данные
│   ├── raw/                       # Исходные данные
│   │   └── russia_crop_yield_dataset_2010_2023.csv
│   └── processed/                 # Обработанные данные
├── models/                        # Сохраненные модели
├── notebooks/                     # Jupyter ноутбуки
│   └── crop_yield_prediction.ipynb  # Основной ноутбук
├── reports/                       # Отчеты и визуализации
├── src/                           # Исходный код
│   ├── __init__.py
│   ├── data_preprocessing.py      # Предобработка данных
│   ├── models.py                  # Архитектуры моделей
│   ├── train.py                   # Обучение
│   └── evaluation.py              # Оценка моделей
├── requirements.txt               # Зависимости
├── LICENSE                        # Лицензия MIT
└── README.md                      # Этот файл
```

## Архитектуры моделей

### 1. LSTM (Long Short-Term Memory)
- Захватывает долгосрочные временные зависимости
- Подходит для метеорологических временных рядов
- Архитектура: 2 слоя LSTM (128, 64 нейрона) + Dense слои

### 2. CNN-LSTM (Гибридная модель)
- CNN слои для извлечения пространственных признаков
- LSTM для временного моделирования
- Архитектура: Conv1D (64, 32 фильтра) + LSTM (64) + Dense

### 3. Transformer
- Механизм самовнимания (self-attention)
- Параллельная обработка последовательностей
- Архитектура: 2 блока Transformer + GlobalAveragePooling

## Метрики оценки

| Метрика | Описание | Формула |
|---------|----------|---------|
| **MAE** | Средняя абсолютная ошибка | $\frac{1}{n}\sum_{i=1}^{n} \|y_i - \hat{y}_i\|$ |
| **RMSE** | Корень из среднеквадратичной ошибки | $\sqrt{\frac{1}{n}\sum_{i=1}^{n} (y_i - \hat{y}_i)^2}$ |
| **R²** | Коэффициент детерминации | $1 - \frac{\sum(y_i - \hat{y}_i)^2}{\sum(y_i - \bar{y})^2}$ |

- **MAE** измеряется в ц/га (центнерах на гектар)
- **RMSE** штрафует большие ошибки сильнее, чем MAE
- **R²** показывает долю объясненной дисперсии (от 0 до 1)

## Установка

### 1. Перейдите в директорию проекта
```bash
cd crop_yield_prediction
```

### 2. Создайте виртуальное окружение
```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

### 3. Установите зависимости
```bash
pip install -r requirements.txt
```

### Основные зависимости
- `tensorflow` — фреймворк глубокого обучения
- `pandas`, `numpy` — работа с данными
- `matplotlib`, `seaborn` — визуализация
- `scikit-learn` — метрики и предобработка
- `jupyter` — интерактивные ноутбуки

## Использование

### Запуск Jupyter Notebook
```bash
jupyter notebook notebooks/crop_yield_prediction.ipynb
```

### Основные шаги в ноутбуке:

1. **Загрузка данных** — чтение CSV файла с данными по регионам
2. **Визуализация** — анализ распределений и корреляций
3. **Предобработка** — нормализация, создание последовательностей
4. **Обучение моделей** — LSTM, CNN-LSTM, Transformer
5. **Оценка** — расчет MAE, RMSE для каждой модели
6. **Визуализация прогнозов** — графики по регионам

### Пример кода для обучения:
```python
# Создание модели
model = build_lstm_model(sequence_length=12, n_features=6)

# Обучение
history = model.fit(X_train, y_train, 
                    epochs=100, 
                    batch_size=32,
                    validation_split=0.2)

# Оценка
y_pred = model.predict(X_test)
mae = mean_absolute_error(y_test, y_pred)
rmse = np.sqrt(mean_squared_error(y_test, y_pred))
```

## Результаты

### Сравнение моделей

| Модель | MAE (ц/га) | RMSE (ц/га) | R² |
|--------|-----------|-------------|-----|
| LSTM | *запуск ноутбука* | *запуск ноутбука* | *запуск ноутбука* |
| CNN-LSTM | *запуск ноутбука* | *запуск ноутбука* | *запуск ноутбука* |
| Transformer | *запуск ноутбука* | *запуск ноутбука* | *запуск ноутбука* |

### Визуализация прогнозов по регионам

Ноутбук включает следующие визуализации:
- **Scatter plots** — сравнение фактических и прогнозируемых значений по регионам
- **Временные ряды** — динамика прогнозов во времени
- **Распределение ошибок** — boxplot ошибок по регионам
- **Сравнение моделей** — bar chart MAE по регионам

## Визуализация прогнозов по регионам

После запуска ноутбука `crop_yield_prediction.ipynb` будут сгенерированы:

1. **Графики рассеяния** (Predicted vs Actual) для каждого региона
2. **Временные ряды** прогнозов с отображением MAE и RMSE
3. **Корреляционная матрица** признаков
4. **Сезонная динамика** NDVI и EVI

Пример вывода:
```
Результаты оценки моделей:
==================================================
Model           MAE             RMSE
--------------------------------------------------
LSTM            2.4532          3.2145
CNN-LSTM        2.1234          2.9876
Transformer     2.3456          3.1023
```

## Задание 2: Прогноз урожайности зерновых по спутниковым данным и метеоинформации

### Описание задачи
- **Задача**: Регрессия — предсказание урожайности зерновых (ц/га) по временным рядам
- **Модели**: LSTM, Transformer, гибрид CNN-LSTM
- **Данные**: NASA POWER (метеоданные), Eurostat crop yield statistics
- **Период**: 2010-2023 гг.
- **Регионы**: Краснодарский край, Ростовская область, Ставропольский край, Саратовская область, Алтайский край

### Требования
- Интеграция спутниковых индексов (NDVI, EVI) и метеоданных
- Оценка MAE, RMSE
- Визуализация прогноза по регионам

### Данные
- `russia_crop_yield_dataset_2010_2023.csv` — данные по урожайности и метеоиндексам

### Структура данных
- `region` — регион
- `year`, `month` — год и месяц
- `NDVI`, `EVI` — спутниковые вегетационные индексы
- `T2M_mean` — средняя температура (°C)
- `PRECTOT_mm` — сумма осадков (мм)
- `SOLAR_RAD_MJ` — солнечная радиация (МДж/м²)
- `yield_centners_per_ha` — целевая переменная (урожайность, ц/га)

### Ноутбук
`notebooks/crop_yield_prediction.ipynb` — полный pipeline:
1. Загрузка и анализ данных по регионам
2. Визуализация распределения урожайности
3. Сезонная динамика NDVI и EVI
4. Подготовка временных последовательностей
5. Модели: LSTM, CNN-LSTM, Transformer
6. Оценка качества (MAE, RMSE, R²)
7. Визуализация прогнозов по регионам

### Метрики
- **MAE** — средняя абсолютная ошибка (ц/га)
- **RMSE** — корень из среднеквадратичной ошибки (ц/га)
- **R²** — коэффициент детерминации

### Архитектура LSTM
- 2 слоя LSTM (128, 64 нейрона)
- Dropout для регуляризации
- Dense слои для регрессии

### Архитектура CNN-LSTM
- Conv1D слои (64, 32 фильтра) для пространственных признаков
- LSTM для временных зависимостей
- Гибридная архитектура

### Архитектура Transformer
- Multi-Head Self-Attention
- Global Average Pooling
- Position-wise Feed-Forward Networks

---

## Задание 4: Обнаружение вредителей или болезней по аудио- или вибрационным сигналам с датчиков

### Описание задачи
- **Задача**: Бинарная классификация (есть вредитель / нет)
- **Модели**: 1D-CNN, Transformer для временных рядов
- **Данные**: Pest Detection Audio Dataset (Kaggle) / Plant Audio Dataset (IEEE)
- **Альтернатива**: Синтезированные данные на основе публикаций

### Требования
- Применение спектрограмм или raw-сигналов
- Кросс-валидация
- Обоснование выбора архитектуры

### Данные
- `pest_audio_detection_dataset.csv` — аудио-сигналы с датчиков

### Структура данных
- `label_pest_present` — целевая переменная (1 = вредитель есть, 0 = нет)
- `signal_0` до `signal_255` — признаки аудио-сигнала (256 значений)

### Ноутбук
`notebooks/pest_detection_audio.ipynb` — полный pipeline:
1. Загрузка и анализ аудио-данных
2. Визуализация сигналов и спектрограмм
3. 1D-CNN для raw-сигналов
4. Transformer для временных рядов
5. Stratified K-Fold кросс-валидация
6. Оценка: accuracy, precision, recall, F1, ROC-AUC

### Метрики
- **Accuracy** — точность классификации
- **Precision** — точность обнаружения
- **Recall** — полнота обнаружения
- **F1-score** — гармоническое среднее
- **ROC-AUC** — площадь под ROC-кривой

### Архитектура 1D-CNN
- Conv1D слои для извлечения признаков из сигналов
- MaxPooling для уменьшения размерности
- Dense слои для классификации

### Архитектура Transformer
- Multi-Head Self-Attention
- Position-wise Feed-Forward Networks
- Global Average Pooling

---

## Задание 10: Прогноз срока созревания посевов с использованием временных рядов NDVI

### Описание задачи
- **Задача**: Регрессия или классификация интервалов созревания
- **Модели**: Transformer, LSTM, TimesNet
- **Данные**: Google Earth Engine (NDVI timelines) + Crop Calendar from FAO
- **Период**: 2019-2023 гг.
- **Регионы**: Краснодарский край, Ростовская область, Ставропольский край, Саратовская область, Алтайский край

### Требования
- Извлечение временных рядов из GEE (Python API)
- Визуализация NDVI динамики
- MAE в днях

### Данные
- `crop_maturity_ndvi_dataset.csv` — данные о сроках созревания по полям
- `ndvi_timeseries_maturity.csv` — временные ряды NDVI/EVI по фенологическим стадиям

### Структура данных
**Основной датасет:**
- `field_id` — идентификатор поля
- `region` — регион
- `crop_type` — тип культуры (wheat, barley, corn, sunflower, oats, peas)
- `planting_date` — дата посева
- `expected_maturity_days` — ожидаемый срок созревания
- `actual_maturity_date` — фактическая дата созревания
- `mae_target` — целевая переменная (дни до созревания)

**Временные ряды:**
- `ndvi`, `evi` — вегетационные индексы
- `gdd_accumulated` — накопленные Growing Degree Days
- `growth_stage` — фенологическая стадия

### Ноутбук
`notebooks/crop_maturity_prediction_ndvi.ipynb` — полный pipeline:
1. Загрузка и анализ данных
2. Визуализация NDVI динамики по стадиям роста
3. Подготовка последовательностей
4. Модели LSTM и Transformer
5. Классификация интервалов созревания
6. Оценка MAE в днях

### Метрики
- **MAE** — средняя абсолютная ошибка в днях
- **RMSE** — корень из среднеквадратичной ошибки
- **Accuracy** — для классификации (раннее/нормальное/позднее)

## Литература

1. NASA POWER Project: https://power.larc.nasa.gov/
2. MODIS Vegetation Indices: https://modis.gsfc.nasa.gov/
3. FAO Crop Calendar: https://cropcalendar.apps.fao.org/
4. Hochreiter, S., & Schmidhuber, J. (1997). Long short-term memory. Neural Computation, 9(8), 1735-1780.
5. Vaswani, A., et al. (2017). Attention is all you need. Advances in Neural Information Processing Systems, 5998-6008.
6. Krizhevsky, A., et al. (2012). ImageNet classification with deep convolutional neural networks. NeurIPS.

## Лицензия

Проект распространяется под лицензией MIT — см. файл [LICENSE](LICENSE).

## Автор

Учебный проект, 2026
